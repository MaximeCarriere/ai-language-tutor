<!doctype html>
<html>
  <head>
    <title>Exercises for Letter {{ letter }}</title>
    <style>
      body { font-family: system-ui,-apple-system,BlinkMacSystemFont,sans-serif; max-width: 900px; margin: 0 auto; padding: 16px; }
      .section { border:1px solid #ccc; padding:16px; margin-bottom:24px; border-radius:8px; }
      .grid { display:flex; gap:12px; flex-wrap:wrap; }
      .box { border:1px solid #888; padding:12px; border-radius:6px; flex:1; min-width:180px; position:relative; }
      .correct { background:#d4f8d4; }
      .wrong { background:#f8d4d4; }
      .btn { padding:6px 10px; cursor:pointer; border-radius:4px; border:1px solid #444; background:#eef; }
      .feedback { margin-top:8px; font-weight:600; }
    </style>
  </head>
  <body>
    <h1>Exercises for Letter {{ letter }}</h1>
    <a href="/letter_lesson?letter={{ letter }}">← Back to Lesson</a>

    <div class="section">
      <h2>1. Recognize the Letter "{{ letter }}"</h2>
      <p>Click the correct letter in each row:</p>
      {% for row in letter_recognition %}
        <div class="box" data-correct="{{ row.correct_index }}">
          <div style="display:flex; gap:8px;">
            {% for ch in row.choices %}
              <div class="choice" style="flex:1; text-align:center; font-size:24px; padding:8px; border:1px solid #aaa; border-radius:4px; cursor:pointer;">
                {{ ch }}
              </div>
            {% endfor %}
          </div>
          <div class="feedback" aria-live="polite"></div>
        </div>
      {% endfor %}
    </div>

    <div class="section">
      <h2>2. Find a Word Containing "{{ letter }}"</h2>
      <p>Select the word that has the letter "{{ letter }}" in it:</p>
      {% for series in word_finder %}
        <div class="box" data-correct="{{ series.correct_index }}">
          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            {% for w in series.choices %}
              <div class="choice" style="padding:8px 12px; border:1px solid #aaa; border-radius:4px; cursor:pointer; margin:4px;">
                {{ w }}
              </div>
            {% endfor %}
          </div>
          <div class="feedback" aria-live="polite"></div>
        </div>
      {% endfor %}
    </div>

    <script>
      // Letter recognition
      document.querySelectorAll('[data-correct]').forEach(box => {
        const correctIndex = parseInt(box.dataset.correct, 10);
        const choices = Array.from(box.querySelectorAll('.choice'));
        choices.forEach((el, idx) => {
          el.addEventListener('click', () => {
            const fb = box.querySelector('.feedback');
            if (idx === correctIndex) {
              el.classList.add('correct');
              fb.textContent = '✅ Correct!';
            } else {
              el.classList.add('wrong');
              fb.textContent = `❌ Nope, that was "${el.textContent}". Try again.`;
            }
          });
        });
      });
    </script>
  </body>
</html>
